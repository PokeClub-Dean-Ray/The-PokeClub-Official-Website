<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Pokeclub - Ultimate Pokémon Hub" />
  <title>Pokeclub – The Ultimate Pokémon Fan Hub</title>
  <style>
    /* Base styles */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0; background: #f9f9ff; color: #222; line-height: 1.6;
      display: flex; flex-direction: column; min-height: 100vh;
    }
    header, footer {
      background: #ffcb05; color: #2a75bb; padding: 1.5rem 2rem; text-align: center;
    }
    main {
      flex-grow: 1; max-width: 900px; margin: 1rem auto 2rem; padding: 0 1rem;
    }
    h1, h2 {
      margin: 0 0 1rem 0;
    }
    button, input[type="text"], input[type="password"], select {
      font-size: 1rem; padding: 0.5rem; border-radius: 6px; border: 2px solid #2a75bb;
    }
    button {
      background: #3b4cca; color: white; border: none; cursor: pointer;
      font-weight: bold; margin-left: 0.5rem;
    }
    button:hover {
      background: #2a75bb;
    }
    /* Layout for login/registration */
    #authSection {
      max-width: 400px; margin: 0 auto 2rem;
      background: #fff; padding: 1rem; border-radius: 10px; box-shadow: 0 0 10px #ccc;
    }
    #authSection h2 {
      color: #2a75bb;
      margin-bottom: 1rem;
    }
    #authSection label {
      display: block; margin: 0.5rem 0 0.2rem 0;
    }
    /* Pokémon search and favorites */
    #searchSection, #favoritesSection, #artGallerySection, #chatSection, #quizSection {
      background: white; padding: 1rem 2rem; border-radius: 10px; margin-bottom: 2rem;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
    }
    /* Pokémon result styling */
    #pokemonResult {
      margin-top: 1rem;
      border: 2px solid #2a75bb;
      border-radius: 10px;
      padding: 1rem;
      max-width: 320px;
      background: #f0f0ff;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
    }
    #pokemonResult img {
      display: block;
      margin: 0 auto 1rem auto;
      width: 150px;
      height: 150px;
      object-fit: contain;
    }
    /* Favorites list */
    #favoritesList {
      list-style: none; padding-left: 0;
    }
    #favoritesList li {
      background: #e5e9f7; margin-bottom: 0.5rem; padding: 0.5rem 1rem;
      border-radius: 6px;
      display: flex; justify-content: space-between; align-items: center;
    }
    #favoritesList button {
      background: #ff4c4c;
      font-weight: normal;
      padding: 0.2rem 0.5rem;
      margin-left: 1rem;
    }
    /* Fan art upload */
    #artPreview {
      max-width: 100%; max-height: 200px; margin-top: 1rem; border-radius: 10px;
      display: none;
      border: 2px solid #2a75bb;
    }
    /* Chatroom */
    #chatMessages {
      max-height: 250px;
      overflow-y: auto;
      background: #f5f7ff;
      border: 2px solid #2a75bb;
      border-radius: 10px;
      padding: 0.5rem 1rem;
      margin-bottom: 1rem;
    }
    .chat-message {
      margin-bottom: 0.5rem;
    }
    .chat-user {
      font-weight: bold;
      color: #2a75bb;
      margin-right: 0.5rem;
    }
    /* Trivia quiz */
    #quizQuestions {
      margin-bottom: 1rem;
    }
    #quizQuestions p {
      margin: 0.3rem 0;
    }
    #quizResult {
      font-weight: bold;
      color: #2a75bb;
    }
    /* Responsive */
    @media (max-width: 600px) {
      main {
        margin: 0.5rem;
        padding: 0 0.5rem;
      }
      #searchSection, #favoritesSection, #artGallerySection, #chatSection, #quizSection {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Pokeclub – The Ultimate Pokémon Fan Hub</h1>
    <p>Unite, explore, battle, and share your love of Pokémon!</p>
  </header>

  <main>

    <!-- Auth Section -->
    <section id="authSection">
      <h2>User Login / Register</h2>
      <form id="authForm">
        <label for="username">Username:</label>
        <input type="text" id="username" required autocomplete="off" />
        <label for="password">Password:</label>
        <input type="password" id="password" required autocomplete="off" />
        <div style="margin-top: 1rem;">
          <button type="submit" id="loginBtn">Login</button>
          <button type="button" id="registerBtn">Register</button>
        </div>
      </form>
      <p id="authMessage" style="color: red; font-weight: bold; margin-top: 1rem;"></p>
    </section>

    <!-- Search Section -->
    <section id="searchSection" style="display:none;">
      <h2>Find Your Pokémon</h2>
      <input type="text" id="pokemonName" placeholder="Enter Pokémon name or ID" />
      <button id="searchBtn">Search</button>
      <div id="errorMsg" style="color:red; font-weight:bold; margin-top:0.5rem;"></div>
      <div id="pokemonResult" style="display:none;">
        <h3 id="pokeName"></h3>
        <img id="pokeImage" src="" alt="Pokémon Image" />
        <p><strong>Type:</strong> <span id="pokeType"></span></p>
        <p><strong>Height:</strong> <span id="pokeHeight"></span> dm</p>
        <p><strong>Weight:</strong> <span id="pokeWeight"></span> hg</p>
        <button id="addFavoriteBtn">Add to Favorites</button>
      </div>
    </section>

    <!-- Favorites Section -->
    <section id="favoritesSection" style="display:none;">
      <h2>Your Favorite Pokémon</h2>
      <ul id="favoritesList"></ul>
      <button id="clearFavoritesBtn">Clear All Favorites</button>
    </section>

    <!-- Fan Art Upload Section -->
    <section id="artGallerySection" style="display:none;">
      <h2>Fan Art Gallery</h2>
      <input type="file" id="artUpload" accept="image/*" />
      <img id="artPreview" alt="Preview of uploaded art" />
      <p id="uploadMessage" style="color: green; font-weight: bold;"></p>
    </section>

    <!-- Chat Section -->
    <section id="chatSection" style="display:none;">
      <h2>Live Chatroom</h2>
      <div id="chatMessages"></div>
      <input type="text" id="chatInput" placeholder="Type your message here..." autocomplete="off" />
      <button id="sendChatBtn">Send</button>
    </section>

    <!-- Trivia Quiz Section -->
    <section id="quizSection" style="display:none;">
      <h2>Weekly Pokémon Trivia Quiz</h2>
      <div id="quizQuestions"></div>
      <button id="submitQuizBtn">Submit Answers</button>
      <p id="quizResult"></p>
    </section>

  </main>

  <footer>
    <p>© 2025 Pokeclub. Created by a true Pokémon fan (not Ray, who’s hopeless).</p>
  </footer>

<script>
  // Store users in localStorage (simulate backend)
  let users = JSON.parse(localStorage.getItem('pokeUsers')) || {};

  // Current logged in user
  let currentUser = localStorage.getItem('pokeCurrentUser') || null;

  // Favorites for each user stored separately
  let favorites = JSON.parse(localStorage.getItem('pokeFavorites')) || {};

  // Chat messages stored in localStorage for demo (shared chat)
  let chatMessages = JSON.parse(localStorage.getItem('pokeChatMessages')) || [];

  // Trivia questions
  const triviaQuestions = [
    {
      question: "Which Pokémon is known as the 'Electric Mouse'?",
      options: ["Charmander", "Pikachu", "Bulbasaur", "Squirtle"],
      answer: "Pikachu"
    },
    {
      question: "What type is Charizard?",
      options: ["Fire/Flying", "Water", "Grass", "Electric"],
      answer: "Fire/Flying"
    },
    {
      question: "Which move is super effective against Water types?",
      options: ["Thunderbolt", "Vine Whip", "Flamethrower", "Ice Beam"],
      answer: "Vine Whip"
    }
  ];

  // Utility function to save all data back to localStorage
  function saveData() {
    localStorage.setItem('pokeUsers', JSON.stringify(users));
    localStorage.setItem('pokeCurrentUser', currentUser);
    localStorage.setItem('pokeFavorites', JSON.stringify(favorites));
    localStorage.setItem('pokeChatMessages', JSON.stringify(chatMessages));
  }

  // Elements shortcuts
  const authSection = document.getElementById('authSection');
  const searchSection = document.getElementById('searchSection');
  const favoritesSection = document.getElementById('favoritesSection');
  const artGallerySection = document.getElementById('artGallerySection');
  const chatSection = document.getElementById('chatSection');
  const quizSection = document.getElementById('quizSection');

  const authForm = document.getElementById('authForm');
  const usernameInput = document.getElementById('username');
  const passwordInput = document.getElementById('password');
  const authMessage = document.getElementById('authMessage');
  const loginBtn = document.getElementById('loginBtn');
  const registerBtn = document.getElementById('registerBtn');

  const pokemonNameInput = document.getElementById('pokemonName');
  const searchBtn = document.getElementById('searchBtn');
  const errorMsg = document.getElementById('errorMsg');
  const pokemonResult = document.getElementById('pokemonResult');
  const pokeName = document.getElementById('pokeName');
  const pokeImage = document.getElementById('pokeImage');
  const pokeType = document.getElementById('pokeType');
  const pokeHeight = document.getElementById('pokeHeight');
  const pokeWeight = document.getElementById('pokeWeight');
  const addFavoriteBtn = document.getElementById('addFavoriteBtn');

  const favoritesList = document.getElementById('favoritesList');
  const clearFavoritesBtn = document.getElementById('clearFavoritesBtn');

  const artUpload = document.getElementById('artUpload');
  const artPreview = document.getElementById('artPreview');
  const uploadMessage = document.getElementById('uploadMessage');

  const chatMessagesDiv = document.getElementById('chatMessages');
  const chatInput = document.getElementById('chatInput');
  const sendChatBtn = document.getElementById('sendChatBtn');

  const quizQuestionsDiv = document.getElementById('quizQuestions');
  const submitQuizBtn = document.getElementById('submitQuizBtn');
  const quizResult = document.getElementById('quizResult');

  // ---------- AUTHENTICATION ----------

  function showAuthMessage(msg, isError = true) {
    authMessage.style.color = isError ? 'red' : 'green';
    authMessage.textContent = msg;
  }

  function updateUIForLoggedIn() {
    authSection.style.display = 'none';
    searchSection.style.display = 'block';
    favoritesSection.style.display = 'block';
    artGallerySection.style.display = 'block';
    chatSection.style.display = 'block';
    quizSection.style.display = 'block';
    loadFavorites();
    loadChat();
    renderQuiz();
  }

  function updateUIForLoggedOut() {
    authSection.style.display = 'block';
    searchSection.style.display = 'none';
    favoritesSection.style.display = 'none';
    artGallerySection.style.display = 'none';
    chatSection.style.display = 'none';
    quizSection.style.display = 'none';
  }

  registerBtn.addEventListener('click', () => {
    const username = usernameInput.value.trim().toLowerCase();
    const password = passwordInput.value;

    if (!username || !password) {
      showAuthMessage("Please enter both username and password.");
      return;
    }
    if (users[username]) {
      showAuthMessage("Username already exists. Try logging in.");
      return;
    }

    users[username] = { password };
    favorites[username] = [];
    saveData();
    showAuthMessage("Registration successful! You can now log in.", false);
  });

  authForm.addEventListener('submit', e => {
    e.preventDefault();
    const username = usernameInput.value.trim().toLowerCase();
    const password = passwordInput.value;

    if (!users[username]) {
      showAuthMessage("Username not found. Please register.");
      return;
    }
    if (users[username].password !== password) {
      showAuthMessage("Incorrect password. Try again.");
      return;
    }
    currentUser = username;
    saveData();
    showAuthMessage("");
    updateUIForLoggedIn();
  });

  // Check if user is already logged in on page load
  if (currentUser && users[currentUser]) {
    updateUIForLoggedIn();
  } else {
    updateUIForLoggedOut();
  }

  // ---------- POKEMON SEARCH ----------

  searchBtn.addEventListener('click', async () => {
    const query = pokemonNameInput.value.trim().toLowerCase();
    errorMsg.textContent = "";
    pokemonResult.style.display = "none";

    if (!query) {
      errorMsg.textContent = "Please enter a Pokémon name or ID.";
      return;
    }

    try {
      const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${query}`);
      if (!response.ok) throw new Error("Pokémon not found.");
      const data = await response.json();

      pokeName.textContent = capitalize(data.name);
      pokeImage.src = data.sprites.front_default || '';
      pokeImage.alt = data.name + " image";
      pokeType.textContent = data.types.map(t => capitalize(t.type.name)).join(", ");
      pokeHeight.textContent = data.height;
      pokeWeight.textContent = data.weight;
      pokemonResult.style.display = "block";
    } catch (err) {
      errorMsg.textContent = err.message;
    }
  });

  function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  }

  // ---------- FAVORITES ----------

  addFavoriteBtn.addEventListener('click', () => {
    if (!currentUser) return;

    const name = pokeName.textContent;
    if (!name) return;

    if (!favorites[currentUser]) favorites[currentUser] = [];
    if (favorites[currentUser].includes(name)) {
      alert(`${name} is already in your favorites.`);
      return;
    }
    favorites[currentUser].push(name);
    saveData();
    loadFavorites();
  });

  function loadFavorites() {
    favoritesList.innerHTML = "";
    if (!favorites[currentUser]) favorites[currentUser] = [];
    favorites[currentUser].forEach(poke => {
      const li = document.createElement('li');
      li.textContent = poke;
      const removeBtn = document.createElement('button');
      removeBtn.textContent = 'Remove';
      removeBtn.addEventListener('click', () => {
        favorites[currentUser] = favorites[currentUser].filter(p => p !== poke);
        saveData();
        loadFavorites();
      });
      li.appendChild(removeBtn);
      favoritesList.appendChild(li);
    });
  }

  clearFavoritesBtn.addEventListener('click', () => {
    if (confirm("Clear all your favorite Pokémon?")) {
      favorites[currentUser] = [];
      saveData();
      loadFavorites();
    }
  });

  // ---------- FAN ART UPLOAD ----------

  artUpload.addEventListener('change', () => {
    const file = artUpload.files[0];
    if (!file) return;
    if (!file.type.startsWith('image/')) {
      uploadMessage.style.color = 'red';
      uploadMessage.textContent = "Please upload a valid image file.";
      artPreview.style.display = 'none';
      return;
    }

    const reader = new FileReader();
    reader.onload = function (e) {
      artPreview.src = e.target.result;
      artPreview.style.display = 'block';
      uploadMessage.style.color = 'green';
      uploadMessage.textContent = "Preview of your fan art. (Upload saved locally)";
    };
    reader.readAsDataURL(file);
  });

  // ---------- CHATROOM ----------

  function renderChat() {
    chatMessagesDiv.innerHTML = '';
    chatMessages.forEach(({user, msg, time}) => {
      const div = document.createElement('div');
      div.classList.add('chat-message');
      const userSpan = document.createElement('span');
      userSpan.classList.add('chat-user');
      userSpan.textContent = user + ':';
      const msgSpan = document.createElement('span');
      msgSpan.textContent = " " + msg;
      div.appendChild(userSpan);
      div.appendChild(msgSpan);
      chatMessagesDiv.appendChild(div);
    });
    chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight;
  }

  sendChatBtn.addEventListener('click', () => {
    const msg = chatInput.value.trim();
    if (!msg) return;
    chatMessages.push({user: currentUser, msg, time: new Date().toISOString()});
    saveData();
    renderChat();
    chatInput.value = '';
  });

  function loadChat() {
    renderChat();
  }

  // ---------- TRIVIA QUIZ ----------

  function renderQuiz() {
    quizQuestionsDiv.innerHTML = '';
    quizResult.textContent = '';
    triviaQuestions.forEach((q, i) => {
      const div = document.createElement('div');
      div.classList.add('quiz-question');
      const questionP = document.createElement('p');
      questionP.textContent = (i+1) + '. ' + q.question;
      div.appendChild(questionP);

      q.options.forEach(option => {
        const id = `q${i}_opt_${option}`;
        const label = document.createElement('label');
        label.htmlFor = id;
        const radio = document.createElement('input');
        radio.type = 'radio';
        radio.name = `q${i}`;
        radio.id = id;
        radio.value = option;
        label.appendChild(radio);
        label.appendChild(document.createTextNode(option));
        div.appendChild(label);
        div.appendChild(document.createElement('br'));
      });

      quizQuestionsDiv.appendChild(div);
    });
  }

  submitQuizBtn.addEventListener('click', () => {
    let score = 0;
    for (let i=0; i < triviaQuestions.length; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (selected && selected.value === triviaQuestions[i].answer) {
        score++;
      }
    }
    quizResult.textContent = `You scored ${score} out of ${triviaQuestions.length}!`;
  });

</script>
</body>
</html>
